<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
    xmlns:jsf="http://xmlns.jcp.org/jsf"	
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<ui:fragment>
	
		<div class="box">

    	 	<h:panelGroup id="panel_filtroTabela" 
    	 				layout="block" 
    	 				styleClass="box-header with-border">
    	 				
                    <div class="row">
      	            	<div class="col-md-8">
      	            	<h:panelGroup styleClass="form-group form-control-calendar">
      	            		<div class="col-md-2">
			            		<p:calendar id="fdataini" 
    	           		 				value="#{produtoBean.dataini}"
        	            	        	mask="true"
            	            		    pattern="dd/MM/yyyy"
										converter="dateCalendarConverter">
								</p:calendar>
							</div>
						</h:panelGroup>
      	            	<h:panelGroup styleClass="form-group form-control-calendar">
      	            		<div class="col-md-2">
		            		<p:calendar id="fdatafim" 
               		 				value="#{produtoBean.datafim}"
                    	        	mask="true"
                        		    pattern="dd/MM/yyyy"
									converter="dateCalendarConverter">
							</p:calendar>
							</div>
						</h:panelGroup>
      	            	<h:panelGroup styleClass="form-group">
      	            		<div class="col-md-3">
								<p:inputText  id="id_ped" 
											  styleClass="form-control"
								              value="#{produtoBean.codigo}" 
								              placeholder="id produto, cod oracle" >
								</p:inputText>
							</div>
						</h:panelGroup>
      	            	<h:panelGroup styleClass="form-group">
      	            		<div class="col-md-3">
								<p:inputText  id="filtro"
										    styleClass="form-control" 
								            value="#{produtoBean.filtro}" 
								            placeholder="descricao , categoria" >
								</p:inputText>
							</div>
						</h:panelGroup>
      	            	<h:panelGroup styleClass="form-group">
      	            		<div class="col-md-2">
			    				<p:commandLink id="btBusca"
	    			    		             actionListener="#{bean.buscaTabela()}" 
	    			            		     update="panel_tabela"
											 styleClass="btn btn-flat btn-default">
									<i class="fa fa-search"/>
								</p:commandLink>
							</div>
						</h:panelGroup>
						</div>

						<div class="col-md-4">
							<div class="box-tools pull-right">
                       			<p:commandButton immediate="true"
                           	           value="Novo"
                           	           icon="fa fa-plus"
                           	           resetValues="true"
                           	           actionListener="#{bean.modoNovoCadastro()}"
                                   	   styleClass="btn btn-flat btn-info"
                                   	   rendered="#{usuarioLogado.temPermissao('R_PRODUTO_NEW')}" />
                            </div> 
			    		</div>
			    	</div>
				
			</h:panelGroup>
 				    
    	 	<h:panelGroup id="panel_tabela" 
    	 				layout="block" 
    	 				styleClass="box-body">
				
					<p:dataTable value="#{bean.produtos}" 
						             var="produto" 
						             id="tblProdutos"
						             widgetVar="tabela"
						             selection="#{bean.produto}"
						             selectionMode="single"
						             rowKey="#{produto.id}"
						             rows="10" paginator="true" paginatorPosition="bottom">
						             
						<p:ajax event="rowSelect" listener="#{bean.selecionaObj}" />
						   
						<p:column sortable="true" sortBy="#{produto.id}">
							<f:facet name="header">id</f:facet>
							<h:outputText value="#{produto.id}"/>
						</p:column>
						
						<p:column sortable="true" sortBy="#{produto.id}" filterable="true" filterBy="#{produto.descricao}"> 
							<f:facet name="header">Descrição</f:facet>
							<h:outputText value="#{produto.descricao}"/>
						</p:column>
						
						<p:column>
							<f:facet name="header">Categoria</f:facet>
							<h:outputText value="#{produto.categoria}"/>
						</p:column>
						
						<p:column>
							<f:facet name="header">Preco</f:facet>
							<h:outputText value="#{produto.preco}"/>
						</p:column>
						
						<p:column>
							<f:facet name="header">Inicio</f:facet>
							<h:outputText value="#{produto.datainicio.time}">
								<f:convertDateTime pattern="dd/MM/yyyy"  />
							</h:outputText>
						</p:column>
						
						<p:column>
							<f:facet name="header">Fim</f:facet>
							<h:outputText value="#{produto.datafim.time}">
								<f:convertDateTime pattern="dd/MM/yyyy"  />
							</h:outputText>
						</p:column>
						
						<p:column>
							<f:facet name="header">Ativo</f:facet>
							<h:outputText value="#{produto.regAtivo}"/>
						</p:column>
						
						<p:column>
							<f:facet name="header">Cadastrado Por</f:facet>
							<h:outputText value="#{produto.criadoPor.nome}"/>
						</p:column>
						
						<p:column  
                                  styleClass="align-center"
                                  headerText="acoes">
							<f:facet name="header">Ações</f:facet>
	
	                        <p:commandButton icon="fa fa-edit"
                            	             title="Alterar"
                                	         styleClass="btn btn-flat btn-default"
                                	         update="panel_conteudo"
                                    	     actionListener="#{bean.modoEdicao() }" />
                                    	     
							<ui:remove>						
							<p:commandLink icon="fa fa-upload"
                            	             title="Upload Imagem"
                                	         styleClass="btn btn-flat btn-default"
                                    	     action="#{produtoBean.showUpload(produto.id) }" /> 
                        	<p:spacer width="10"/>
                        	<p:commandButton icon="fa fa-remove"
                            	             title="Remover"
                                	         styleClass="btn btn-flat btn-default"
                                    	     actionListener="#{produtoBean.changeToDelete(produto.id) }" />
							</ui:remove>
                                    	      
						</p:column>
							
					</p:dataTable>
					
			</h:panelGroup>
			
		</div>
	
</ui:fragment>

</html>



